{
  "last_node_id": 114,
  "last_link_id": 133,
  "nodes": [
    {
      "id": 63,
      "type": "load_persona",
      "pos": [
        -30,
        10
      ],
      "size": {
        "0": 320,
        "1": 110
      },
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [
        {
          "name": "file_content",
          "type": "STRING",
          "link": null,
          "widget": {
            "name": "file_content"
          },
          "label": "file_content"
        }
      ],
      "outputs": [
        {
          "name": "system_prompt",
          "type": "STRING",
          "links": [
            72
          ],
          "shape": 3,
          "label": "system_prompt",
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "load_persona"
      },
      "widgets_values": [
        "omost",
        true,
        ""
      ],
      "shape": 1
    },
    {
      "id": 67,
      "type": "show_text_party",
      "pos": [
        780,
        -300
      ],
      "size": {
        "0": 410,
        "1": 600
      },
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [
        {
          "name": "text",
          "type": "STRING",
          "link": 74,
          "widget": {
            "name": "text"
          },
          "label": "text"
        }
      ],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "links": null,
          "shape": 6,
          "label": "STRING"
        }
      ],
      "properties": {
        "Node name for S&R": "show_text_party"
      },
      "widgets_values": [
        "",
        "```python\n# Initialize the canvas\ncanvas = Canvas()\n\n# Set a global description for the canvas\ncanvas.set_global_description(\n    description='A 3D cartoon-style plush toy of a small tiger wearing a chef hat and a red hat, enclosed in a bubble.',\n    detailed_descriptions=[\n        'The image features a delightful 3D cartoon-style plush toy of a small tiger.',\n        'The tiger is wearing a chef hat that has a white band and a red hat atop it, giving it a playful and charming appearance.',\n        'The plush toy is enclosed in a bubble, which adds a whimsical and magical touch to the image.',\n        'The bubble is transparent with a slight glow around it, making the plush toy inside look like it is floating in mid-air.',\n        'The background is soft and blurred, ensuring that the focus remains on the plush toy and its bubble.',\n        'The overall atmosphere of the image is joyful and enchanting, perfect for a plush toy collector or a child who loves tigers and playful designs.',\n    ],\n    tags='3D, cartoon, plush toy, tiger, chef hat, red hat, bubble, whimsical, magical, floating, mid-air, soft background, joyful, enchanting, collectible, playful, charming, transparent, glow, whimsical, magical, enchanting',\n    HTML_web_color_name='lightpink',\n)\n\n# Add the 3d cartoon-style plush toy of a small tiger.\ncanvas.add_local_description(\n    location='in the center',\n    offset='no offset',\n    area='a medium-sized square area',\n    distance_to_viewer=1.0,\n    description='The 3D cartoon-style plush toy of a small tiger.',\n    detailed_descriptions=[\n        'The plush toy is a charming 3D cartoon-style representation of a small tiger.',\n        'It is made to look adorable and friendly, with large, expressive eyes and a cute smile.',\n        'The plush toy is made of soft, plush material that looks comfortable to hold.',\n        'The details are carefully crafted to make the tiger look lively and endearing.',\n        'The plush toy is wearing a chef hat that has a white band, adding to its playful and charming appearance.',\n        'The tiger also wears a red hat atop the chef hat, which enhances its overall look.',\n        'The plush toy is well-posed, giving it a dynamic and engaging presence in the image.',\n    ],\n    tags='3D, cartoon, plush toy, tiger, chef hat, red hat, adorable, friendly, expressive eyes, cute smile, soft material, comfortable, charming, playful, lively, endearing, well-posed, dynamic',\n    atmosphere='The atmosphere is joyful and enchanting, perfect for a plush toy collector.',\n    style='The style is 3D cartoon-style, with attention to detail and a playful design.',\n    quality_meta='The quality is high, with well-crafted details and a comfortable design.',\n    HTML_web_color_name='goldenrod',\n)\n\n# Add the red hat worn by the tiger plush toy.\ncanvas.add_local_description(\n    location='on the top',\n    offset='slightly to the left',\n    area='a small square area',\n    distance_to_viewer=1.2,\n    description='The red hat worn by the tiger plush toy.',\n    detailed_descriptions=[\n        'The red hat worn by the tiger plush toy is a small but noticeable accessory.',\n        'It is a vibrant red color with a slight sheen, making it stand out.',\n        'The hat is positioned atop the chef hat, which adds to the playful and charming appearance of the plush toy.',\n        'The red hat is well-crafted, with a smooth texture and a perfectly rounded shape.',\n        'It enhances the overall look of the plush toy, making it look more adorable and friendly.',\n        \"The red hat is an integral part of the plush toy's design, contributing to its whimsical and enchanting appearance.\",\n    ],\n    tags='red hat, tiger plush toy, accessory, vibrant, sheen, playful, charming, well-crafted, smooth texture, rounded shape, adorable, friendly, integral design, whimsical, enchanting',\n    atmosphere='The red hat adds a playful and charming touch to the overall image.',\n    style='The style is playful and charming, with a focus on small but noticeable details.',\n    quality_meta='The quality is high, with a smooth texture and a perfectly rounded shape.',\n    HTML_web_color_name='red',\n)\n\n# Add the chef hat worn by the tiger plush toy.\ncanvas.add_local_description(\n    location='on the top',\n    offset='slightly to the right',\n    area='a small square area',\n    distance_to_viewer=1.2,\n    description='The chef hat worn by the tiger plush toy.',\n    detailed_descriptions=[\n        'The chef hat worn by the tiger plush toy is a small but noticeable accessory.',\n        'It is white with a slight sheen, and it has a white band around the base.',\n        'The hat is positioned under the red hat, adding to the playful and charming appearance of the plush toy.',\n        'The chef hat is well-crafted, with a smooth texture and a perfectly rounded shape.',\n        'It enhances the overall look of the plush toy, making it look more adorable and friendly.',\n        'The chef hat is an integral part of the plush toy’s design, contributing to its whimsical and enchanting appearance.',\n    ],\n    tags='chef hat, tiger plush toy, accessory, white, sheen, playful, charming, well-crafted, smooth texture, rounded shape, adorable, friendly, integral design, whimsical, enchanting',\n    atmosphere='The chef hat adds a playful and charming touch to the overall image.',\n    style='The style is playful and charming, with a focus on small but noticeable details.',\n    quality_meta='The quality is high, with a smooth texture and a perfectly rounded shape.',\n    HTML_web_color_name='white',\n)\n\n# Add the bubble enclosing the plush toy.\ncanvas.add_local_description(\n    location='in the center',\n    offset='slightly to the lower',\n    area='a large square area',\n    distance_to_viewer=1.0,\n    description='The bubble enclosing the plush toy.',\n    detailed_descriptions=[\n        'The bubble is a large, transparent orb that encloses the plush toy.',\n        'The bubble has a slight glow around it, making the plush toy inside look like it is floating in mid-air.',\n        'The bubble is carefully crafted to appear delicate and whimsical, adding a magical touch to the image.',\n        'The inside of the bubble is slightly foggy, which adds to the enchanting and playful atmosphere.',\n        'The bubble is positioned around the plush toy, ensuring that it remains the focal point of the image.',\n        'The overall design of the bubble is intricate, with a smooth texture and a perfect spherical shape.',\n    ],\n    tags='bubble, plush toy, transparent, orb, glow, floating, mid-air, delicate, whimsical, magical, foggy, enchanting, playful, focal point, intricate, smooth texture, spherical shape',\n    atmosphere='The bubble adds a whimsical and magical touch to the overall image.',\n    style='The style is intricate and delicate, with a focus on whimsical and magical elements.',\n    quality_meta='The quality is high, with a smooth texture and a perfect spherical shape.',\n    HTML_web_color_name='lightblue',\n)\n```"
      ],
      "shape": 1
    },
    {
      "id": 95,
      "type": "Note",
      "pos": [
        -430,
        -300
      ],
      "size": {
        "0": 370,
        "1": 750
      },
      "flags": {},
      "order": 1,
      "mode": 0,
      "properties": {
        "text": ""
      },
      "widgets_values": [
        "#工作流介绍：\n -该工作流是通过加载张吕敏（ControlNet作者）微调后的llama模型omost，生成一段关于图像生成的复杂指令，以此实现质量更佳的图片。\n\n#omost介绍：\n- omost的优点：\n·生成的图像几乎就是你想要的结果；\n·“O”代表“omoni”，也就是多模态的意思，项目尽可能多地从LLM中获取能力；\n\n- omost的能力：\n·首先我们给LLM一段自然语言文本，（例如：请画一个迪士尼3D卡通风格的，戴着红色帽子的小狗厨师，眼睛是蓝色的，毛发是白色的），然后LLM大语言模型会编写代码来组合图像视觉内容，\n我们之前只是通过LLM简单的对提示词的优化和扩展。\n   ·omost生成python代码包含了边界框、图像标签、风格氛围质量等指令，通过omost的虚拟画布来实现。这个虚拟画布通过特定的图像生成器来实际生成我们需要的图像。\n   ·简化理解：自然语言→LLM生成python代码→将python代码转换为多个包含遮罩信息的条件信息→将多个条件信息以贪婪算法融合→生成区域可控的图像\n\n——————————————————————————————————\n#omost本地模型下载链接：\n·百度网盘：\nhttps://pan.baidu.com/s/1T4aEB4HumdJ7iVbvsv1vzA?pwd=qyhu 提取码: qyhu\n\n下载后安装到本地，在【本地大语言模型加载/Local Large language Model Loader】中的[model_path]和[tokenizer_path]中填入omost本地文件夹的路径（例如：E:\\GitHub\\model\\omost）。\n\n——————————————————————————————————\n#写在最后：\n·LLM_Party正在用心经营一片AI时代后花园，我们希望能够在AI时代下成为众多参与者的一员，我们从开源社区中走来，也希望回到社区中去。\n·欢迎大家来到我们用心经营的后花园：\n- QQ交流群：931057213\n- 微信交流群：Choo-Yong（添加小助理微信，统一通过后会添加至交流群）"
      ],
      "color": "#432",
      "bgcolor": "#653",
      "shape": 1
    },
    {
      "id": 75,
      "type": "easy setNode",
      "pos": [
        -20,
        170
      ],
      "size": {
        "0": 310,
        "1": 60
      },
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "link": 80
        }
      ],
      "title": "Set_prompt",
      "properties": {
        "previousName": "prompt"
      },
      "widgets_values": [
        "prompt"
      ],
      "color": "#223",
      "shape": 1
    },
    {
      "id": 104,
      "type": "VAEDecode",
      "pos": [
        1460,
        20
      ],
      "size": {
        "0": 150,
        "1": 50
      },
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 113,
          "label": "Latent"
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 114,
          "label": "VAE",
          "slot_index": 1
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            121
          ],
          "shape": 3,
          "label": "图像",
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "VAEDecode"
      },
      "shape": 1
    },
    {
      "id": 98,
      "type": "CheckpointLoaderNF4",
      "pos": [
        1230,
        -290,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "size": {
        "0": 380,
        "1": 100
      },
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [
            108
          ],
          "slot_index": 0,
          "shape": 3,
          "label": "MODEL"
        },
        {
          "name": "CLIP",
          "type": "CLIP",
          "links": [],
          "slot_index": 1,
          "shape": 3,
          "label": "CLIP"
        },
        {
          "name": "VAE",
          "type": "VAE",
          "links": [
            114
          ],
          "slot_index": 2,
          "shape": 3,
          "label": "VAE"
        }
      ],
      "properties": {
        "Node name for S&R": "CheckpointLoaderNF4"
      },
      "widgets_values": [
        "12-FLUX模型/flux1-dev-bnb-nf4.safetensors"
      ],
      "shape": 1
    },
    {
      "id": 110,
      "type": "DualCLIPLoader",
      "pos": [
        1220,
        -150
      ],
      "size": {
        "0": 390,
        "1": 110
      },
      "flags": {},
      "order": 3,
      "mode": 0,
      "outputs": [
        {
          "name": "CLIP",
          "type": "CLIP",
          "links": [
            133
          ],
          "shape": 3,
          "label": "CLIP",
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "DualCLIPLoader"
      },
      "widgets_values": [
        "FLUX_clipvision_models/t5xxl_fp16.safetensors",
        "FLUX_clipvision_models/clip_l.safetensors",
        "flux"
      ],
      "shape": 1
    },
    {
      "id": 111,
      "type": "CLIPTextEncode",
      "pos": [
        1230,
        10
      ],
      "size": {
        "0": 210,
        "1": 60
      },
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 133,
          "label": "CLIP"
        },
        {
          "name": "text",
          "type": "STRING",
          "link": 132,
          "widget": {
            "name": "text"
          },
          "label": "文本",
          "slot_index": 1
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "links": [
            128
          ],
          "shape": 3,
          "label": "条件",
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        "",
        true
      ],
      "shape": 1
    },
    {
      "id": 61,
      "type": "LLM_local_loader",
      "pos": [
        -30,
        -290
      ],
      "size": {
        "0": 320,
        "1": 220
      },
      "flags": {},
      "order": 4,
      "mode": 0,
      "outputs": [
        {
          "name": "model",
          "type": "CUSTOM",
          "links": [
            70
          ],
          "shape": 3,
          "label": "model",
          "slot_index": 0
        },
        {
          "name": "tokenizer",
          "type": "CUSTOM",
          "links": [
            71
          ],
          "shape": 3,
          "label": "tokenizer",
          "slot_index": 1
        }
      ],
      "properties": {
        "Node name for S&R": "LLM_local_loader"
      },
      "widgets_values": [
        "llama",
        "llama",
        "/hy-tmp/AI_files/models/omost",
        "/hy-tmp/AI_files/models/omost",
        "cuda",
        "float32",
        true
      ],
      "shape": 1
    },
    {
      "id": 101,
      "type": "FluxSamplerParams+",
      "pos": [
        1230,
        170,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "size": {
        "0": 390,
        "1": 280
      },
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 108,
          "label": "model"
        },
        {
          "name": "conditioning",
          "type": "CONDITIONING",
          "link": 128,
          "label": "conditioning"
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 109,
          "label": "latent_image",
          "slot_index": 2
        }
      ],
      "outputs": [
        {
          "name": "latent",
          "type": "LATENT",
          "links": [
            113
          ],
          "slot_index": 0,
          "shape": 3,
          "label": "latent"
        },
        {
          "name": "params",
          "type": "SAMPLER_PARAMS",
          "links": [],
          "slot_index": 1,
          "shape": 3,
          "label": "params"
        }
      ],
      "properties": {
        "Node name for S&R": "FluxSamplerParams+"
      },
      "widgets_values": [
        "564646",
        "euler",
        "simple",
        "20",
        "3.5",
        "",
        "",
        ""
      ],
      "shape": 1
    },
    {
      "id": 102,
      "type": "EmptyLatentImage",
      "pos": [
        1380,
        120
      ],
      "size": {
        "0": 210,
        "1": 110
      },
      "flags": {
        "collapsed": true
      },
      "order": 5,
      "mode": 0,
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [
            109
          ],
          "shape": 3,
          "label": "Latent",
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "EmptyLatentImage"
      },
      "widgets_values": [
        1024,
        1024,
        4
      ],
      "shape": 1
    },
    {
      "id": 71,
      "type": "LLM_local",
      "pos": [
        310,
        -290
      ],
      "size": {
        "0": 450,
        "1": 590
      },
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "CUSTOM",
          "link": 70,
          "label": "model"
        },
        {
          "name": "tokenizer",
          "type": "CUSTOM",
          "link": 71,
          "label": "tokenizer"
        },
        {
          "name": "image",
          "type": "IMAGE",
          "link": null,
          "label": "image"
        },
        {
          "name": "system_prompt_input",
          "type": "STRING",
          "link": 72,
          "widget": {
            "name": "system_prompt_input"
          },
          "label": "system_prompt_input"
        },
        {
          "name": "user_prompt_input",
          "type": "STRING",
          "link": null,
          "widget": {
            "name": "user_prompt_input"
          },
          "label": "user_prompt_input"
        },
        {
          "name": "tools",
          "type": "STRING",
          "link": null,
          "widget": {
            "name": "tools"
          },
          "label": "tools"
        },
        {
          "name": "file_content",
          "type": "STRING",
          "link": null,
          "widget": {
            "name": "file_content"
          },
          "label": "file_content"
        }
      ],
      "outputs": [
        {
          "name": "assistant_response",
          "type": "STRING",
          "links": [
            74,
            80,
            132
          ],
          "shape": 3,
          "label": "assistant_response",
          "slot_index": 0
        },
        {
          "name": "history",
          "type": "STRING",
          "links": [],
          "shape": 3,
          "label": "history"
        },
        {
          "name": "tool",
          "type": "STRING",
          "links": [],
          "shape": 3,
          "label": "tool",
          "slot_index": 2
        },
        {
          "name": "image",
          "type": "IMAGE",
          "links": null,
          "shape": 3,
          "label": "image"
        }
      ],
      "properties": {
        "Node name for S&R": "LLM_local"
      },
      "widgets_values": [
        "",
        "请画一个泡泡玛特3D卡通风格的，戴着红色帽子的带着厨师帽的小老虎盲盒",
        "llama",
        0.7,
        2048,
        "disable",
        "disable",
        "enable",
        "",
        "",
        "",
        "",
        100,
        "",
        true,
        true,
        true
      ],
      "shape": 1
    },
    {
      "id": 57,
      "type": "PreviewImage",
      "pos": [
        1650,
        -290
      ],
      "size": {
        "0": 760,
        "1": 740
      },
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 121,
          "label": "图像"
        }
      ],
      "properties": {
        "Node name for S&R": "PreviewImage"
      },
      "shape": 1
    }
  ],
  "links": [
    [
      70,
      61,
      0,
      71,
      0,
      "CUSTOM"
    ],
    [
      71,
      61,
      1,
      71,
      1,
      "CUSTOM"
    ],
    [
      72,
      63,
      0,
      71,
      3,
      "STRING"
    ],
    [
      74,
      71,
      0,
      67,
      0,
      "STRING"
    ],
    [
      80,
      71,
      0,
      75,
      0,
      "*"
    ],
    [
      108,
      98,
      0,
      101,
      0,
      "MODEL"
    ],
    [
      109,
      102,
      0,
      101,
      2,
      "LATENT"
    ],
    [
      113,
      101,
      0,
      104,
      0,
      "LATENT"
    ],
    [
      114,
      98,
      2,
      104,
      1,
      "VAE"
    ],
    [
      121,
      104,
      0,
      57,
      0,
      "IMAGE"
    ],
    [
      128,
      111,
      0,
      101,
      1,
      "CONDITIONING"
    ],
    [
      132,
      71,
      0,
      111,
      1,
      "STRING"
    ],
    [
      133,
      110,
      0,
      111,
      0,
      "CLIP"
    ]
  ],
  "groups": [
    {
      "title": "Omost for Prompt ",
      "bounding": [
        -40,
        -370,
        1240,
        690
      ],
      "color": "#3f789e",
      "font_size": 24,
      "locked": false
    },
    {
      "title": "OutPut",
      "bounding": [
        1640,
        -370,
        770,
        830
      ],
      "color": "#3f789e",
      "font_size": 24,
      "locked": false
    },
    {
      "title": "LLM_Party for Omost+FLUX",
      "bounding": [
        -40,
        330,
        1240,
        130
      ],
      "color": "#3f789e",
      "font_size": 95,
      "locked": false
    },
    {
      "title": "Note",
      "bounding": [
        -440,
        -370,
        390,
        830
      ],
      "color": "#3f789e",
      "font_size": 24,
      "locked": false
    },
    {
      "title": "FLUX Model+ Sampling",
      "bounding": [
        1210,
        -370,
        420,
        830
      ],
      "color": "#3f789e",
      "font_size": 24,
      "locked": false
    }
  ],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.8769226950000014,
      "offset": {
        "0": 392.27568893629484,
        "1": 51.56225599076214
      }
    }
  },
  "version": 0.4
}